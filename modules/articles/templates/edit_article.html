{% extends "layout.html" %}
{% from 'article_macros.html' import show_article %}

{% block head %}
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='js/codemirror/lib/codemirror.css')}}" />
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/article.css')}}" />
<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='css/admin.css')}}" />

<style type="text/css">
.CodeMirror {
    border: 1px solid #eee;
}
.CodeMirror-scroll {
    height: auto;
    overflow-y: hidden;
    overflow-x: auto;
    width: 100%;
}
</style>

{% endblock %}

{% block script %}
<script type="text/javascript" src="{{url_for('static', filename='js/tiny_mce/tiny_mce.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='js/tiny_mce/jquery.tinymce.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='js/codemirror/lib/codemirror.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='js/codemirror/lib/util/overlay.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='js/codemirror/lib/util/dialog.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='js/codemirror/mode/htmlmixed/htmlmixed.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='js/codemirror/mode/xml/xml.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='js/codemirror/mode/css/css.js')}}"></script>
<script type="text/javascript" src="{{url_for('static', filename='js/codemirror/mode/javascript/javascript.js')}}"></script>
{% endblock %}

{% block body %}
<div id="admin-main">
<form class="model-edit-form" method="POST" action="{{url_for('.edit_article', articleid=article.id)}}" >
<div id="upper-form" class="model-edit-form  article-content">
<fieldset>
    <legend>
        Editing: {{article}}
    </legend>
    
  <div class="field-container">
    <label  for="title">Title</label>
    <input class="article-title" style="width:80%;" id="title" name="title" type="text" value="{{article.get_title()}}" />
  </div>
  <div class="field-container">
    <label for="body">Body</label>
    <textarea style="width:100%; height: 400px;" id="body" name="body" class="main-content">{{article.get_body()|safe}}</textarea>
  </div>
  <div class="field-container">
    <label  for="css">Stylesheet</label>
    <textarea id="code-css" name="css">{{article.get_stylesheet()|safe}}</textarea>
  </div>
  <div class="field-container">
    <label for="javascript_before">Javascript Before (the javascript here will be placed before the article)</label>
    <textarea  id="javascript_before" name="javascript_before">{{article.get_javascript_before()|safe}}</textarea>
  </div>
  <div class="field-container">
    <label for="javascript_after">Javascript After (the javascript here will be placed after the article)</label>
    <textarea id="javascript_after" name="javascript_after">{{article.get_javascript_after()|safe}}</textarea>
  </div>
  
  <div class="field-container">
    <label for="author_blurb">About The Author</label>
    <textarea id="author_blurb" name="author_blurb">{{article.get_author_blurb()|safe}}</textarea>
  </div>
  
</fieldset>
</div>

<input id="submit" type="submit" value="Submit" class="button"/>
        
</form>
</div>
<script type="text/javascript">
var editor_css, editor_js1, editor_js2;

editor_css = CodeMirror.fromTextArea(document.getElementById("code-css"), {
    lineNumbers: true,
    theme: "default",
    mode: "css",
    extraKeys: {
        "Ctrl-I": autoIndentDoc
    }
});

editor_js1 = CodeMirror.fromTextArea(document.getElementById("javascript_before"), {
    lineNumbers: true,
    theme: "default",
    mode: "javascript",
    extraKeys: {
        "Ctrl-I": autoIndentDoc
    }
});

editor_js1 = CodeMirror.fromTextArea(document.getElementById("javascript_after"), {
    lineNumbers: true,
    theme: "default",
    mode: "javascript",
    extraKeys: {
        "Ctrl-I": autoIndentDoc
    }
}); 

tinymce.init({
    mode: "textareas",
    editor_selector: "main-content",

    theme : "advanced",
	scrollbars: true,
    plugins : "jqueryinlinepopups,style,table,advimage,advlink,preview,contextmenu,paste,fullscreen,xhtmlxtras",
    theme_advanced_buttons1 : "code,preview,|,bold,italic,underline,|,justifyleft,justifycenter,justifyright,justifyfull,|,formatselect,fontselect,fontsizeselect",
    theme_advanced_buttons2 : "styleprops,|,attribs,|,tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|,fullscreen",
    theme_advanced_buttons3 : "cut,copy,paste,pastetext,|,bullist,numlist,blockquote,|,undo,redo,|,link,unlink,anchor,image,cleanup,|,forecolor,backcolor",
    theme_advanced_toolbar_location : "top",
    theme_advanced_toolbar_align : "left",
    theme_advanced_statusbar_location : "bottom",
    theme_advanced_resizing : false,        
    theme_advanced_resize_horizontal : 1,
    theme_advanced_resizing_use_cookie : 0,
    content_css: "../static/css/content.css"
});
function autoIndentDoc() {
/*
    var lineCount = editor.lineCount();
    for(var line = 0; line < lineCount; line++) {
       editor.indentLine(line);
    }
    */
}
</script>
{% endblock %}

